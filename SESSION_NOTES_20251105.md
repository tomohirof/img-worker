# ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒãƒ¼ãƒˆ - 2025å¹´11æœˆ5æ—¥

## å®Ÿæ–½å†…å®¹

### 1. æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ ğŸš€
**å®Œäº†æ™‚åˆ»**: ã‚»ãƒƒã‚·ãƒ§ãƒ³å…¨ä½“

#### 1.1 Cloudflare Workersã®ãƒ‡ãƒ—ãƒ­ã‚¤
- **wrangler.tomlã®ä¿®æ­£**
  - API_KEYã‚’`[vars]`ã‹ã‚‰å‰Šé™¤ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Šï¼‰
  - `.dev.vars`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼‰
  - `.gitignore`ã«`.dev.vars`ã‚’è¿½åŠ 

- **API_KEYã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆåŒ–**
  - `wrangler secret put API_KEY`ã‚³ãƒãƒ³ãƒ‰ã§è¨­å®š
  - æœ¬ç•ªç’°å¢ƒã§ã‚»ã‚­ãƒ¥ã‚¢ã«ç®¡ç†

- **ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ**
  - `npm run deploy`ã§ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸ
  - ãƒ‡ãƒ—ãƒ­ã‚¤URL: https://ogp-worker.tomohirof.workers.dev
  - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã€ç”»åƒç”ŸæˆAPIã®å‹•ä½œç¢ºèªæ¸ˆã¿

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«**:
- `wrangler.toml`
- `.dev.vars`ï¼ˆæ–°è¦ä½œæˆï¼‰
- `.gitignore`

**ã‚³ãƒŸãƒƒãƒˆ**:
- `14882ce` - fix: Next.js 15å¯¾å¿œã¨æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤ã®æº–å‚™

---

#### 1.2 GitHubãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆ
- **ãƒªãƒã‚¸ãƒˆãƒªURL**: https://github.com/tomohirof/img-worker
- `gh repo create`ã‚³ãƒãƒ³ãƒ‰ã§ä½œæˆ
- ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒ`origin/main`ã«ãƒ—ãƒƒã‚·ãƒ¥å®Œäº†

---

#### 1.3 Cloudflare Pagesã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

##### 1.3.1 @cloudflare/next-on-pagesã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- `@cloudflare/next-on-pages`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- `vercel`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆãƒ“ãƒ«ãƒ‰ä¾å­˜ï¼‰
- `next.config.js`ã‚’ä½œæˆ
  - ç”»åƒæœ€é©åŒ–ã‚’ç„¡åŠ¹åŒ–ï¼ˆCloudflare Pageså¯¾å¿œï¼‰
  - ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
- `pages:build`ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ 

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«**:
- `img-worker-templates/package.json`
- `img-worker-templates/package-lock.json`
- `img-worker-templates/next.config.js`ï¼ˆæ–°è¦ä½œæˆï¼‰

**ã‚³ãƒŸãƒƒãƒˆ**:
- `a017f96` - feat: Cloudflare Pageså¯¾å¿œã®è¨­å®šã‚’è¿½åŠ 

---

##### 1.3.2 Next.js 15ã®å‹ã‚¨ãƒ©ãƒ¼ä¿®æ­£

**å•é¡Œ**: Next.js 15ã§ã¯`params`ãŒPromiseã«ãªã‚‹

**ä¿®æ­£å†…å®¹**:
- `app/templates/[id]/page.tsx`
  - `params: { id: string }` â†’ `params: Promise<{ id: string }>`
  - `await params`ã§å€¤ã‚’å–å¾—
  - `export const runtime = 'edge'`ã‚’è¿½åŠ 

- `app/templates/[id]/edit/page.tsx`
  - åŒæ§˜ã®ä¿®æ­£ã‚’å®Ÿæ–½
  - Edge Runtimeè¨­å®šã‚’è¿½åŠ 

- `app/templates/new/page.tsx`
  - `useSearchParams()`ã®Suspenseå¯¾å¿œ
  - `TemplateEditor.tsx`ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ†é›¢
  - `Suspense`ã§ãƒ©ãƒƒãƒ—

- `components/editor/PropertiesPanel.tsx`
  - ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ãƒŸãƒªãƒ¼ã®å‹ã‚­ãƒ£ã‚¹ãƒˆè¿½åŠ 
  - ãƒ•ã‚©ãƒ³ãƒˆã‚¦ã‚§ã‚¤ãƒˆã®å‹ã‚­ãƒ£ã‚¹ãƒˆè¿½åŠ 

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«**:
- `img-worker-templates/app/templates/[id]/page.tsx`
- `img-worker-templates/app/templates/[id]/edit/page.tsx`
- `img-worker-templates/app/templates/new/page.tsx`
- `img-worker-templates/app/templates/new/TemplateEditor.tsx`ï¼ˆæ–°è¦ä½œæˆï¼‰
- `img-worker-templates/components/editor/PropertiesPanel.tsx`

**ã‚³ãƒŸãƒƒãƒˆ**:
- `7b6a0eb` - fix: å‹•çš„ãƒ«ãƒ¼ãƒˆã«Edge Runtimeè¨­å®šã‚’è¿½åŠ 

---

##### 1.3.3 Cloudflare Pagesã®ãƒ“ãƒ«ãƒ‰è¨­å®š

**ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®è¨­å®š**:

| é …ç›® | å€¤ |
|------|-----|
| **Root directory** | `img-worker-templates` |
| **Build command** | `npm install && npm run build && npm run pages:build` |
| **Build output directory** | `.vercel/output/static` |

**ç’°å¢ƒå¤‰æ•°**:

| å¤‰æ•°å | å€¤ |
|--------|-----|
| `NEXT_PUBLIC_API_BASE_URL` | `https://ogp-worker.tomohirof.workers.dev` |
| `NEXT_PUBLIC_API_KEY` | `cwe8yxq4mtc-HCZ9ebm` |
| `NODE_VERSION` | `20` |

**äº’æ›æ€§ãƒ•ãƒ©ã‚°**:
- Production: `nodejs_compat`
- Preview: `nodejs_compat`

---

##### 1.3.4 ãƒ‡ãƒ—ãƒ­ã‚¤çµæœ

âœ… **ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸ**
- æœ¬ç•ªURL: https://img-worker-templates.pages.dev
- å…¨ãƒšãƒ¼ã‚¸æ­£å¸¸è¡¨ç¤º
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†æ©Ÿèƒ½ãŒå‹•ä½œ
- ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ãŒå‹•ä½œ
- APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒè¡¨ç¤º

**ãƒ“ãƒ«ãƒ‰ã‚µãƒãƒªãƒ¼**:
- Edge Function Routes: 2
  - `/templates/[id]`
  - `/templates/[id]/edit`
- Prerendered Routes: 18
- Other Static Assets: 33

---

## æœ¬ç•ªç’°å¢ƒã®æ§‹æˆ

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆCloudflare Pagesï¼‰
- **URL**: https://img-worker-templates.pages.dev
- **æŠ€è¡“**: Next.js 15 (App Router) + TypeScript
- **äº’æ›æ€§ãƒ•ãƒ©ã‚°**: `nodejs_compat`
- **è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤**: GitHubã®mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆCloudflare Workersï¼‰
- **URL**: https://ogp-worker.tomohirof.workers.dev
- **æŠ€è¡“**: Hono + Satori + resvg-wasm
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**:
  - KV: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†
  - R2: ç”»åƒãƒ»ã‚µãƒ ãƒã‚¤ãƒ«ä¿å­˜

### ãƒªãƒã‚¸ãƒˆãƒª
- **GitHub**: https://github.com/tomohirof/img-worker
- **ãƒ–ãƒ©ãƒ³ãƒ**: `main`

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ï¼ˆå‹ã‚¨ãƒ©ãƒ¼ï¼‰
**ã‚¨ãƒ©ãƒ¼å†…å®¹**: `params`ã®å‹ãŒNext.js 15ã§å¤‰æ›´ã•ã‚ŒãŸ

**è§£æ±ºæ–¹æ³•**:
```typescript
// Before
export default function Page({ params }: { params: { id: string } }) {
  redirect(`/templates/${params.id}/edit`);
}

// After
export default async function Page({
  params,
}: {
  params: Promise<{ id: string }>;
}) {
  const { id } = await params;
  redirect(`/templates/${id}/edit`);
}
```

---

### å•é¡Œ2: Edge Runtimeã‚¨ãƒ©ãƒ¼
**ã‚¨ãƒ©ãƒ¼å†…å®¹**: å‹•çš„ãƒ«ãƒ¼ãƒˆãŒEdge Runtimeã«è¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```typescript
export const runtime = 'edge';
```
ã‚’å„å‹•çš„ãƒ«ãƒ¼ãƒˆã«è¿½åŠ 

---

### å•é¡Œ3: Node.jsäº’æ›æ€§ã‚¨ãƒ©ãƒ¼
**ã‚¨ãƒ©ãƒ¼å†…å®¹**: `nodejs_compat`ãƒ•ãƒ©ã‚°ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
Cloudflare Pagesã®è¨­å®šã§ã€Production/Previewã®ä¸¡æ–¹ã«`nodejs_compat`ãƒ•ãƒ©ã‚°ã‚’è¿½åŠ 

---

### å•é¡Œ4: useSearchParams()ã®Suspenseã‚¨ãƒ©ãƒ¼
**ã‚¨ãƒ©ãƒ¼å†…å®¹**: `useSearchParams()`ãŒSuspenseãƒã‚¦ãƒ³ãƒ€ãƒªãƒ¼ã§å›²ã¾ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ†é›¢ã—ã¦ã€Suspenseã§ãƒ©ãƒƒãƒ—

```tsx
// page.tsx
<Suspense fallback={<Loading />}>
  <TemplateEditor />
</Suspense>
```

---

## ç¾åœ¨ã®ç®¡ç†ç”»é¢ã®å…¨æ©Ÿèƒ½

### 1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ (`/`)
- ã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚è¦ã¨çµ±è¨ˆæƒ…å ±
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ•°ã®è¡¨ç¤º

### 2. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç† (`/templates`)
- ã‚«ãƒ¼ãƒ‰å½¢å¼ã®ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤º
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤
- ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¨ãƒ‡ã‚£ã‚¿
  - ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—
  - ãƒ†ã‚­ã‚¹ãƒˆç·¨é›†
  - ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  - è‡ªå‹•ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆ

### 3. ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆ (`/generate-test`)
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ä»˜ãï¼‰
- è‡ªå‹•ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆã‚µãƒ ãƒã‚¤ãƒ«å„ªå…ˆï¼‰
- å‹•çš„ãƒ•ã‚©ãƒ¼ãƒ ç”Ÿæˆ
- PNG/SVGå½¢å¼é¸æŠ
- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½

### 4. APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ (`/api-docs`)
- å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®è©³ç´°èª¬æ˜
- å®Ÿè¡Œå¯èƒ½ãªã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®èª¬æ˜

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- Next.js 15 (App Router)
- TypeScript
- Tailwind CSS
- React 19
- Lucide Icons
- AdminLayoutï¼ˆå…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- Cloudflare Workers
- Hono Framework
- KV Storageï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰
- R2 Storageï¼ˆç”»åƒãƒ»ã‚µãƒ ãƒã‚¤ãƒ«ï¼‰

### ç”»åƒç”Ÿæˆ
- Satoriï¼ˆSVGç”Ÿæˆï¼‰
- resvg-wasmï¼ˆPNGå¤‰æ›ï¼‰
- Google Fontsï¼ˆå‹•çš„èª­ã¿è¾¼ã¿ï¼‰

### ãƒ‡ãƒ—ãƒ­ã‚¤
- GitHubï¼ˆã‚½ãƒ¼ã‚¹ç®¡ç†ï¼‰
- Cloudflare Pagesï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
- Cloudflare Workersï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰
- Wrangler CLI

---

## ä»Šå¾Œã®ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ

### ğŸ”¥ å„ªå…ˆåº¦ï¼šæœ€é«˜ï¼ˆæ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰
- [ ] **ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã®å®Ÿè£…**
  - èªè¨¼æ–¹å¼ã®é¸å®šï¼ˆCloudflare Access, Auth.js, ã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ãªã©ï¼‰
  - ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã®ä½œæˆ
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
  - ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆã®å®Ÿè£…
  - ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆç®¡ç†è€…/ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

### å„ªå…ˆåº¦ï¼šé«˜
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½œæˆã¨ãƒ†ã‚¹ãƒˆï¼ˆæœ¬ç•ªç’°å¢ƒã§ï¼‰
- [ ] ç”»åƒç”Ÿæˆã®ãƒ†ã‚¹ãƒˆï¼ˆæœ¬ç•ªç’°å¢ƒã§ï¼‰
- [ ] ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®šï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„
  - APIæ¥ç¶šã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### å„ªå…ˆåº¦ï¼šä¸­
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
  - å¤‰æ›´å±¥æ­´ã®ä¿å­˜
  - ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚«ãƒ†ã‚´ãƒªãƒ¼æ©Ÿèƒ½
  - ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ†é¡
  - ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½
- [ ] ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æ”¹å–„
  - è¤‡æ•°ã‚µã‚¤ã‚ºã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆOGP, Twitter, Facebookï¼‰
  - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
- [ ] ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®å®Ÿè£…
  - APIä½¿ç”¨é‡ã®åˆ¶é™
  - ä¸æ­£ä½¿ç”¨ã®é˜²æ­¢

### å„ªå…ˆåº¦ï¼šä½
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ/ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
  - JSONå½¢å¼ã§ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
  - ä»–ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- [ ] ã‚¢ã‚¯ã‚»ã‚¹è§£æ
  - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½¿ç”¨é »åº¦
  - ç”»åƒç”Ÿæˆå›æ•°
  - Cloudflare Analyticsçµ±åˆ
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å……å®Ÿ
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰
  - APIä½¿ç”¨ä¾‹
  - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

---

## ãƒ¡ãƒ¢

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- API_KEYã¯æœ¬ç•ªç’°å¢ƒã§ã¯ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¨ã—ã¦ç®¡ç†
- ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ã¯`.dev.vars`ï¼ˆ`.gitignore`ã«è¿½åŠ æ¸ˆã¿ï¼‰
- ç¾åœ¨ã¯å˜ä¸€ã®API_KEYã§èªè¨¼ï¼ˆå°†æ¥çš„ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãŒå¿…è¦ï¼‰

### CORSè¨­å®š
- Workerså´ã§ä»¥ä¸‹ã®ã‚ªãƒªã‚¸ãƒ³ã‚’è¨±å¯
  - `localhost:3000`
  - `localhost:3002`
  - `img-worker-templates.pages.dev`
  - `*.img-worker-templates.pages.dev`ï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒç”¨ï¼‰

### R2ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‘ã‚¹
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚µãƒ ãƒã‚¤ãƒ«: `template-thumbnails/{templateId}.png`
- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒ: `images/{fileId}`

### APIèªè¨¼
- ãƒ˜ãƒƒãƒ€ãƒ¼: `x-api-key: cwe8yxq4mtc-HCZ9ebm`
- ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: `?api_key=cwe8yxq4mtc-HCZ9ebm`

### äº’æ›æ€§
- Next.js 15ã®æ–°ã—ã„ä»•æ§˜ã«å®Œå…¨å¯¾å¿œ
- Cloudflare Pagesã®Edge Runtimeå¯¾å¿œ
- Node.js 20äº’æ›

---

## æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ç¢ºèªã™ã‚‹ã“ã¨

### ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã®å®Ÿè£…æº–å‚™
1. **èªè¨¼æ–¹å¼ã®é¸å®š**
   - Cloudflare Accessï¼ˆæ¨å¥¨ã€ç°¡å˜ï¼‰
   - Auth.jsï¼ˆNext-Authï¼‰
   - ã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ï¼ˆJWT + KVï¼‰
   - ãã®ä»–

2. **è¨­è¨ˆæ¤œè¨äº‹é …**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã®æ–¹æ³•
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆCookie, JWT, KVï¼‰
   - ãƒ­ãƒ¼ãƒ«/æ¨©é™ã®è¨­è¨ˆ
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ã®å¿…è¦æ€§
   - ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ã®å¿…è¦æ€§

3. **å®Ÿè£…ã‚¹ã‚³ãƒ¼ãƒ—**
   - æœ€å°é™ã®å®Ÿè£…ç¯„å›²ã‚’æ±ºå®š
   - æ®µéšçš„ãªæ©Ÿèƒ½è¿½åŠ è¨ˆç”»

---

## å‚è€ƒãƒªãƒ³ã‚¯

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Next.js 15 Documentation](https://nextjs.org/docs)
- [Cloudflare Pages Documentation](https://developers.cloudflare.com/pages/)
- [Cloudflare Workers Documentation](https://developers.cloudflare.com/workers/)
- [@cloudflare/next-on-pages](https://github.com/cloudflare/next-on-pages)

### æœ¬ç•ªç’°å¢ƒ
- **ç®¡ç†ç”»é¢**: https://img-worker-templates.pages.dev
- **Workers API**: https://ogp-worker.tomohirof.workers.dev
- **GitHub**: https://github.com/tomohirof/img-worker
- **Cloudflareãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: https://dash.cloudflare.com/

---

## å®Œäº†ã—ãŸãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ ğŸ¯

âœ… ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã®æ§‹ç¯‰
âœ… Workers APIã®å®Ÿè£…
âœ… ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†æ©Ÿèƒ½
âœ… ç”»åƒç”Ÿæˆæ©Ÿèƒ½
âœ… ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¨ãƒ‡ã‚£ã‚¿
âœ… ã‚µãƒ ãƒã‚¤ãƒ«è‡ªå‹•ç”Ÿæˆ
âœ… APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
âœ… æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
ğŸ”„ ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ï¼ˆæ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰

---

**ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚åˆ»**: 2025å¹´11æœˆ5æ—¥
**æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ã‚¿ã‚¹ã‚¯**: ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã®å®Ÿè£…
